p8105\_hw3\_dd2948
================
David DeStephano
October 7, 2019

``` r
library(tidyverse)
```

    ## -- Attaching packages ----------------------- tidyverse 1.2.1 --

    ## v ggplot2 3.2.1     v purrr   0.3.2
    ## v tibble  2.1.3     v dplyr   0.8.3
    ## v tidyr   1.0.0     v stringr 1.4.0
    ## v readr   1.3.1     v forcats 0.4.0

    ## -- Conflicts -------------------------- tidyverse_conflicts() --
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

Problem 1
---------

``` r
library(p8105.datasets)
data("instacart")

instacart %>%
  group_by(aisle) %>%
  summarize(n = n()) %>% 
  arrange(desc(n))
```

    ## # A tibble: 134 x 2
    ##    aisle                              n
    ##    <chr>                          <int>
    ##  1 fresh vegetables              150609
    ##  2 fresh fruits                  150473
    ##  3 packaged vegetables fruits     78493
    ##  4 yogurt                         55240
    ##  5 packaged cheese                41699
    ##  6 water seltzer sparkling water  36617
    ##  7 milk                           32644
    ##  8 chips pretzels                 31269
    ##  9 soy lactosefree                26240
    ## 10 bread                          23635
    ## # ... with 124 more rows

``` r
#Alternatively:
count(instacart, aisle)
```

    ## # A tibble: 134 x 2
    ##    aisle                      n
    ##    <chr>                  <int>
    ##  1 air fresheners candles  1067
    ##  2 asian foods             7007
    ##  3 baby accessories         306
    ##  4 baby bath body care      328
    ##  5 baby food formula      13198
    ##  6 bakery desserts         1501
    ##  7 baking ingredients     13088
    ##  8 baking supplies decor   1094
    ##  9 beauty                   287
    ## 10 beers coolers           1839
    ## # ... with 124 more rows

``` r
#Fresh vegatables is the most popular
```

The dimensions of this data set are 1384617, 15 Key Variables The most ordered from aisle is fresh vegeatables

Plot
====

``` r
instacart %>%
  group_by(aisle) %>%
  summarize(n = n()) %>% 
  filter(n>10000) %>% 
  arrange(desc(n)) %>% 
  ggplot(aes(x = reorder(aisle, n), y = n)) + 
    geom_point() + geom_line() + 
    theme(axis.text.x = element_text(size=6, angle = 45, hjust = 1))
```

    ## geom_path: Each group consists of only one observation. Do you need to
    ## adjust the group aesthetic?

![](p8105_hw3_dd2948_files/figure-markdown_github/unnamed-chunk-3-1.png)

Table showing the tree most popular items in each of the aisles: baking ingredients, dog food care, packaged vegetables fruits
==============================================================================================================================

``` r
instacart %>%
  filter(aisle %in% c('baking ingredients', 'dog food care', 'packaged vegetables fruits')) %>% 
  group_by(aisle, product_name) %>% 
  summarize(n = n()) %>%  
  arrange(aisle, desc(n)) %>%
  slice(1:3)
```

    ## # A tibble: 9 x 3
    ## # Groups:   aisle [3]
    ##   aisle                     product_name                                  n
    ##   <chr>                     <chr>                                     <int>
    ## 1 baking ingredients        Light Brown Sugar                           499
    ## 2 baking ingredients        Pure Baking Soda                            387
    ## 3 baking ingredients        Cane Sugar                                  336
    ## 4 dog food care             Snack Sticks Chicken & Rice Recipe Dog T~    30
    ## 5 dog food care             Organix Chicken & Brown Rice Recipe          28
    ## 6 dog food care             Small Dog Biscuits                           26
    ## 7 packaged vegetables frui~ Organic Baby Spinach                       9784
    ## 8 packaged vegetables frui~ Organic Raspberries                        5546
    ## 9 packaged vegetables frui~ Organic Blueberries                        4966

Make a table showing the mean hour of the day at which Pink Lady Apples and Coffee Ice Cream are ordered on each day of the week; format this table for human readers (i.e. produce a 2 x 7 table)
==================================================================================================================================================================================================

``` r
instacart %>%
  filter(product_name %in% c('Pink Lady Apples', 'Coffee Ice Cream')) %>% 
  group_by(product_name, order_dow) %>% 
  summarize(mean_time = mean(order_hour_of_day)) %>% 
  pivot_wider(
    names_from = product_name,
    values_from = mean_time)  
```

    ## # A tibble: 7 x 3
    ##   order_dow `Coffee Ice Cream` `Pink Lady Apples`
    ##       <int>              <dbl>              <dbl>
    ## 1         0               13.8               13.4
    ## 2         1               14.3               11.4
    ## 3         2               15.4               11.7
    ## 4         3               15.3               14.2
    ## 5         4               15.2               11.6
    ## 6         5               12.3               12.8
    ## 7         6               13.8               11.9

``` r
  #make 2 by 7.. format days
```

Problem 2
---------

``` r
library(p8105.datasets)
data("instacart")
data("BRFSS")
```

    ## Warning in data("BRFSS"): data set 'BRFSS' not found

``` r
brfss <- 
    brfss_smart2010 %>% 
    janitor::clean_names() %>%
  filter(topic=="Overall Health") %>% 
  mutate(response = as.factor(response)) %>% 
  mutate(response =
           factor(response,levels(response)[c(4,2,3,5,1)]))


brfss %>% 
  filter(year==2002) %>%
  group_by(locationabbr) %>% 
  summarize(n_state =n_distinct(locationdesc)) %>% 
  filter(n_state>=7)
```

    ## # A tibble: 6 x 2
    ##   locationabbr n_state
    ##   <chr>          <int>
    ## 1 CT                 7
    ## 2 FL                 7
    ## 3 MA                 8
    ## 4 NC                 7
    ## 5 NJ                 8
    ## 6 PA                10

In 2002, Connectiticut, Florida, Massachusetts, North Carolina, New Jersey, Pennsylvania each were observed at 7 or more locations

``` r
brfss %>% 
  filter(year==2010) %>%
  group_by(locationabbr) %>% 
  summarize(n_state =n_distinct(locationdesc)) %>% 
  filter(n_state>=7)
```

    ## # A tibble: 14 x 2
    ##    locationabbr n_state
    ##    <chr>          <int>
    ##  1 CA                12
    ##  2 CO                 7
    ##  3 FL                41
    ##  4 MA                 9
    ##  5 MD                12
    ##  6 NC                12
    ##  7 NE                10
    ##  8 NJ                19
    ##  9 NY                 9
    ## 10 OH                 8
    ## 11 PA                 7
    ## 12 SC                 7
    ## 13 TX                16
    ## 14 WA                10

In 2010, CA, CO, FL, MA, MD, NC, NE, NJ, NY, OH were observed at 7 or more locations

Limited to excellent responses
==============================

``` r
spaghetti<-brfss %>% 
  filter(response=="Excellent") %>% 
  group_by(year, locationabbr) %>% 
  summarize(mean_data_value=mean(data_value))
```

Make a spaghetti plot
=====================

``` r
spaghetti %>% ggplot(aes(x = year, y = mean_data_value, color = locationabbr)) +
  geom_line(aes(group = locationabbr)) +
  geom_point()+ 
  viridis::scale_fill_viridis(discrete = TRUE)
```

    ## Warning: Removed 3 rows containing missing values (geom_path).

    ## Warning: Removed 4 rows containing missing values (geom_point).

![](p8105_hw3_dd2948_files/figure-markdown_github/unnamed-chunk-9-1.png)

``` r
brfss %>%
  filter(year == c(2006, 2010), locationabbr=="NY") %>%
  ggplot(aes(x = response, y = data_value))+
  geom_violin(aes(fill=response), alpha = .4)+
  facet_grid(~year)+ 
  theme(legend.position = "bottom", axis.text.x = element_text(size=5))
```

    ## Warning in year == c(2006, 2010): longer object length is not a multiple of
    ## shorter object length

![](p8105_hw3_dd2948_files/figure-markdown_github/unnamed-chunk-10-1.png)

Including Plots
---------------

You can also embed plots, for example:

![](p8105_hw3_dd2948_files/figure-markdown_github/pressure-1.png)

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
